---
description: 执行价值交付阶段 - 生成交付文档、验证价值、提取模式、完成闭环（v3.0 集成 continuous-learning-v2）
argument-hint: (可选) 交付类型 (pr|release)
---

# /delivery - 价值交付阶段 v3.0

执行端到端交付流程的最后阶段：价值交付。

**前置条件**: 必须先完成 Verification 阶段

## v3.0 新特性

### continuous-learning-v2 Instinct 学习
自动提取和演化可复用知识：

**Instincts（本能行为）**:
- 原子行为模式，带置信度评分（0.3-0.9）
- Observer Agent 通过 hooks 自动捕获会话数据

**演化路径**:
```
Instincts → Skills → Commands → Agents
   ↓          ↓          ↓          ↓
原子行为    可复用技能   命令行工具  自主代理
```

**相关命令**:
- `/instinct-status` - 查看 Instincts 状态
- `/instinct-export` - 导出 Instincts
- `/instinct-import` - 导入 Instincts
- `/evolve` - 演化 Instincts 为 Skills/Commands/Agents

## 使用方式

```bash
# 启动价值交付阶段
/delivery

# 创建 PR
/delivery pr

# 创建发布
/delivery release
```

## 阶段目标

完成交付并沉淀知识，确保价值闭环。

## 交付流程

### 1. 交付就绪检查
```markdown
## 交付就绪检查

### 阶段完成确认
- [ ] Discovery - 需求已明确
- [ ] Exploration - 代码库已分析
- [ ] Design - 架构已设计
- [ ] Implementation - 代码已实现
- [ ] Verification - 质量已验证

### 质量门禁
- [ ] 构建成功
- [ ] 类型检查通过
- [ ] 代码规范通过
- [ ] 测试覆盖率 ≥ 80%
- [ ] 安全扫描通过

### 交付材料
- [ ] 变更日志
- [ ] 发布说明
- [ ] 技术文档
```

### 2. 交付文档生成

#### 变更日志
```markdown
# [Feature Name] 变更日志

## 版本: X.Y.Z

### 新增
- feat: [功能描述]

### 修改
- fix: [修复描述]

### 文档
- docs: [文档更新]

## 变更文件
- 新增: [文件列表]
- 修改: [文件列表]

## 依赖变更
- 新增: [依赖]
- 升级: [依赖]
```

#### 发布说明
```markdown
# [Feature Name] 发布说明

## 概述
[一句话描述]

## 主要功能
### 功能 1
**描述**: [详细描述]
**价值**: [用户价值]
**使用方式**: [示例]

## 问题修复
- [修复的问题]

## 升级指南
1. [步骤 1]
2. [步骤 2]
```

#### 技术文档
```markdown
# [Feature Name] 技术文档

## 架构设计
[架构描述]

## API 设计
### 端点列表
- `POST /api/xxx` - [描述]

### 请求/响应
[接口定义]

## 数据模型
[类型定义]

## 测试策略
- 单元测试: [覆盖率]
- 集成测试: [覆盖率]
- E2E 测试: [覆盖场景]
```

### 3. 价值验证

```markdown
# 价值验证报告

## 需求追溯
### 原始需求
[来自 discovery]

### 验收标准
| AC ID | 验收标准 | 状态 | 证据 |
|-------|----------|------|------|
| AC-001 | [标准] | ✅ | [测试链接] |
| AC-002 | [标准] | ✅ | [测试链接] |

## 非功能需求验证
### 性能
| 指标 | 目标 | 实际 | 状态 |
|------|------|------|------|
| 响应时间 | < X ms | Y ms | ✅ |

### 安全
- [ ] 安全扫描通过
- [ ] 安全审查通过

## 价值测量
### 业务价值
- [解决了什么问题]
- [带来了什么改进]

### 用户价值
- [用户体验改进]
- [效率提升]
```

### 4. 模式提取

```markdown
# 模式提取与学习

## 新发现的模式
### 代码模式
- **模式**: [名称]
- **问题**: [解决什么]
- **方案**: [如何解决]
- **示例**: [代码示例]

### 最佳实践
1. [实践]
   - 为什么好
   - 如何复用

### 经验教训
1. [问题]
   - 如何解决
   - 如何避免

## 可复用组件
- 组件 1: `path/to/component`
- 工具 1: `path/to/tool`

## 更新的知识库
- 新增技能: `skills/xxx/`
- 更新文档: `docs/xxx/`
- 新增规则: `rules/xxx/`
```

### 5. 交付总结

```markdown
# 交付总结

## 概述
- **功能**: [功能名称]
- **版本**: X.Y.Z
- **状态**: ✅ 已交付

## 关键指标
- **实施时间**: X 天
- **代码变更**: X 行
- **测试覆盖**: XX%

## 交付内容
### 代码
- 新增: X 个文件
- 修改: X 个文件

### 文档
- 变更日志
- 发布说明
- 技术文档

### 测试
- 单元测试: X 个
- 集成测试: X 个
- E2E 测试: X 个

## 质量评估
- [ ] 代码规范通过
- [ ] 测试覆盖达标
- [ ] 安全扫描通过
- [ ] 需求全部实现

## 后续计划
### 短期
- [ ] [任务]
### 中期
- [ ] [任务]
### 长期
- [ ] [任务]

## 闭环反馈
本次交付学到的模式将用于改进后续流程:
- [模式 1] → [改进方向]
- [模式 2] → [改进方向]
```

## PR 创建

### PR 描述模板
```markdown
## 描述
[简要描述]

## 变更类型
- [ ] 新功能 (feature)
- [ ] Bug 修复 (fix)
- [ ] 重构 (refactor)

## 相关 Issue
Closes #[issue]

## 变更内容
- [变更 1]
- [变更 2]

## 测试
- [ ] 单元测试通过
- [ ] 集成测试通过
- [ ] E2E 测试通过
- [ ] 测试覆盖率 ≥ 80%

## 检查清单
- [ ] 代码符合规范
- [ ] 代码已自审
- [ ] 文档已更新
- [ ] 没有新的警告

## 截图/演示
[截图]
```

## 质量门禁

完成价值交付前，确认:
- [ ] 所有阶段完成
- [ ] 质量门禁通过
- [ ] 交付文档完整
- [ ] 价值已验证
- [ ] 模式已提取
- [ ] PR/发布准备就绪

## 闭环完成

```markdown
┌─────────────────────────────────────────────────────────────┐
│                    价值闭环完成 ✅                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   Discovery → Exploration → Design → Implementation        │
│      ✅          ✅            ✅          ✅               │
│                                                             │
│   Verification → Delivery → Learning                       │
│        ✅         ✅         ✅                            │
│                                                             │
│   价值已验证 ✓                                              │
│   模式已提取 ✓                                              │
│   知识已沉淀 ✓                                              │
│                                                             │
│   持续改进 → 下一次交付更好                                  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

**恭喜！** 端到端价值交付闭环已完成。

通过这次交付，我们不仅交付了功能，还:
- ✅ 验证了价值
- ✅ 提取了模式
- ✅ 沉淀了知识
- ✅ 改进了流程

这就是端到端价值交付闭环的真正意义。
