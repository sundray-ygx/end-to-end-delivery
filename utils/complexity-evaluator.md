# 复杂度评估工具 (Complexity Evaluator)

## 概述

复杂度评估工具用于评估用户需求的复杂程度，为后续的开发模式选择（瀑布流/敏捷）和模板选择提供依据。

## 评估维度

### 1. 功能复杂度 (Functional Complexity)

| 等级 | 描述 | 分值 |
|------|------|------|
| 低 | 单一功能，简单逻辑 | 1-3 |
| 中 | 多个相关功能，中等逻辑 | 4-6 |
| 高 | 复杂业务逻辑，多系统集成 | 7-10 |

**评估指标：**
- 涉及的功能模块数量
- 数据流复杂度
- 业务规则复杂度
- 接口数量

### 2. 技术复杂度 (Technical Complexity)

| 等级 | 描述 | 分值 |
|------|------|------|
| 低 | 成熟技术，无架构变更 | 1-3 |
| 中 | 部分新技术，小规模架构调整 | 4-6 |
| 高 | 新技术引入，大规模架构重构 | 7-10 |

**评估指标：**
- 新技术引入程度
- 架构变更范围
- 集成难度
- 技术风险

### 3. 规模复杂度 (Scale Complexity)

| 等级 | 描述 | 分值 |
|------|------|------|
| 低 | 小规模，1-3人天 | 1-3 |
| 中 | 中等规模，3-10人天 | 4-6 |
| 高 | 大规模，10+人天 | 7-10 |

**评估指标：**
- 预估工作量
- 团队规模
- 开发周期
- 涉及的代码行数

### 4. 风险复杂度 (Risk Complexity)

| 等级 | 描述 | 分值 |
|------|------|------|
| 低 | 低风险，可控 | 1-3 |
| 中 | 中等风险，需缓解措施 | 4-6 |
| 高 | 高风险，需详细预案 | 7-10 |

**评估指标：**
- 技术风险
- 业务风险
- 时间风险
- 依赖风险

## 综合评分

### 计算公式

```
总分 = (功能复杂度 × 1.0) + (技术复杂度 × 1.2) + (规模复杂度 × 1.0) + (风险复杂度 × 1.5)
```

### 复杂度等级判定

| 总分 | 复杂度等级 | 开发模式 | 设计模板 |
|------|-----------|---------|---------|
| 0-7 | **低复杂度** | 敏捷 (Agile) | module-mini-design-spec-v1.4.md |
| 8-11 | **中复杂度** | 敏捷 (Agile) | module-detailed-design-spec-v3.6.md |
| 12+ | **高复杂度** | 瀑布流 (Waterfall) | overall-design-spec-v4.1.md |

## 评估流程

### Step 1: 收集信息

通过用户描述和澄清问题，收集以下信息：
- 功能需求详情
- 技术约束条件
- 工作量预估
- 风险因素

### Step 2: 维度评分

对每个维度进行评分，记录评分依据。

### Step 3: 计算总分

使用加权公式计算综合得分。

### Step 4: 确定等级

根据总分确定复杂度等级。

### Step 5: 输出报告

生成复杂度评估报告，包含：
- 各维度得分
- 综合得分
- 复杂度等级
- 推荐开发模式
- 推荐模板

## 评估报告模板

```markdown
# 需求复杂度评估报告

## 需求概述
[需求名称和简要描述]

## 维度评分

### 功能复杂度: X/10
**评分依据:**
- 涉及模块: X 个
- 数据流: [简单/中等/复杂]
- 业务规则: [简单/中等/复杂]
- 接口数量: X 个

### 技术复杂度: X/10
**评分依据:**
- 新技术引入: [无/部分/大量]
- 架构变更: [无/小规模/大规模]
- 集成难度: [简单/中等/复杂]
- 技术风险: [低/中/高]

### 规模复杂度: X/10
**评分依据:**
- 预估工作量: X 人天
- 团队规模: X 人
- 开发周期: X 周
- 代码规模: [估算]

### 风险复杂度: X/10
**评分依据:**
- 技术风险: [低/中/高]
- 业务风险: [低/中/高]
- 时间风险: [低/中/高]
- 依赖风险: [低/中/高]

## 综合评分

| 维度 | 得分 | 权重 | 加权得分 |
|------|------|------|---------|
| 功能复杂度 | X | 1.0 | X |
| 技术复杂度 | X | 1.2 | X |
| 规模复杂度 | X | 1.0 | X |
| 风险复杂度 | X | 1.5 | X |
| **总分** | | | **X** |

## 复杂度等级

**等级:** [低/中/高] 复杂度
**总分:** X
**开发模式:** [敏捷/瀑布流]
**需求模板:** [模板名称]
**设计模板:** [模板名称]

## 建议

[基于复杂度等级的详细建议]
```

## 使用示例

### 示例 1: 低复杂度需求

**需求**: "添加一个用户头像上传功能"

**评估:**
- 功能复杂度: 2/10 (单一功能)
- 技术复杂度: 2/10 (成熟技术)
- 规模复杂度: 2/10 (1-2人天)
- 风险复杂度: 2/10 (低风险)

**总分**: 2×1.0 + 2×1.2 + 2×1.0 + 2×1.5 = **9.4**

**结果**: 低复杂度 → 敏捷模式 → module-mini-design-spec-v1.4.md

### 示例 2: 高复杂度需求

**需求**: "重构整个订单系统，支持分布式事务"

**评估:**
- 功能复杂度: 9/10 (复杂业务逻辑)
- 技术复杂度: 8/10 (新技术引入)
- 规模复杂度: 8/10 (大规模)
- 风险复杂度: 9/10 (高风险)

**总分**: 9×1.0 + 8×1.2 + 8×1.0 + 9×1.5 = **47.1**

**结果**: 高复杂度 → 瀑布流模式 → overall-design-spec-v4.1.md

## 配置选项

```json
{
  "complexity": {
    "thresholds": {
      "high": 12,
      "medium": 8
    },
    "weights": {
      "functional": 1.0,
      "technical": 1.2,
      "scale": 1.0,
      "risk": 1.5
    }
  }
}
```

## 注意事项

1. **主观性**: 复杂度评估有一定主观性，建议结合团队讨论
2. **动态调整**: 随着需求变化，需要重新评估复杂度
3. **历史参考**: 参考历史项目的复杂度评估结果
4. **阈值定制**: 不同团队可以定制不同的阈值和权重

## 与代理集成

- **Discovery Agent**: 在需求分析阶段进行复杂度评估
- **Design Agent**: 根据复杂度选择设计模板
- **Implementation Agent**: 根据复杂度调整实施策略
